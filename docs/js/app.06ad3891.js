(function(e){function t(t){for(var a,i,o=t[0],c=t[1],d=t[2],l=0,h=[];l<o.length;l++)i=o[l],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&h.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/koikoi/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("85ec"),s=n.n(a);s.a},1:function(e,t){},2655:function(e,t,n){"use strict";var a=n("3054"),s=n.n(a);s.a},2727:function(e,t,n){},3054:function(e,t,n){},"3fac":function(e,t,n){"use strict";var a=n("2727"),s=n.n(a);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Room")],1)},r=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"room"},[n("game",{staticClass:"game"}),n("chat",{staticClass:"chat"})],1)},o=[],c=n("8055"),d=n.n(c),u=d.a.connect("https://shielded-ridge-48598.herokuapp.com/"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"game"},[n("point-pile",{staticClass:"opPointPile",attrs:{cards:e.opPointPile}}),n("span",{staticClass:"table"},[n("img",{staticClass:"deck",attrs:{src:"images/black.png"}}),n("transition-group",{staticClass:"transition-group",attrs:{name:"table",tag:"div"}},e._l(e.tableCards,(function(t,a){return n("card",{key:JSON.stringify(t),staticClass:"card",attrs:{card:t,"border-color":void 0!==t&&t.month===e.selectedMonth?"yellow":"transparent"},on:{click:function(t){return e.selectTable(a)}}})})),1)],1),n("span",{staticClass:"hand"},e._l(e.handCards,(function(t,a){return n("card",{key:JSON.stringify(t),staticClass:"card",attrs:{card:t},on:{click:function(t){return e.selectHand(a)}}})})),1),n("point-pile",{staticClass:"myPointPile",attrs:{cards:e.myPointPile}})],1)},h=[],p=(n("4de4"),n("4160"),n("159b"),n("99af"),n("d4ec")),f=n("bee2");function m(e,t,n,a){console.log("send c2s_play:"+e+" "+t+" "+n+" "+JSON.stringify(a)),u.emit("c2s_play",Object.assign({operation:e,next:t,gameInfo:n},a))}function b(e,t,n){console.assert(e.operation===t&&e.next===n,"\nexpected:"+t+", "+n+"\nactual:"+e.operation+", "+e.next)}var v=n("694b");function y(e){return[e,e,e,e,e,e,e,e]}var g=[{month:1,number:1,type:["hikari"]},{month:1,number:2,type:["tan","akatan"]},{month:1,number:3,type:["kasu"]},{month:1,number:4,type:["kasu"]},{month:2,number:1,type:["tane"]},{month:2,number:2,type:["tan","akatan"]},{month:2,number:3,type:["kasu"]},{month:2,number:4,type:["kasu"]},{month:3,number:1,type:["hikari"]},{month:3,number:2,type:["tan","akatan"]},{month:3,number:3,type:["kasu"]},{month:3,number:4,type:["kasu"]},{month:4,number:1,type:["tane"]},{month:4,number:2,type:["tan"]},{month:4,number:3,type:["kasu"]},{month:4,number:4,type:["kasu"]},{month:5,number:1,type:["tane"]},{month:5,number:2,type:["tan"]},{month:5,number:3,type:["kasu"]},{month:5,number:4,type:["kasu"]},{month:6,number:1,type:["tane","inoshikacho"]},{month:6,number:2,type:["tan","aotan"]},{month:6,number:3,type:["kasu"]},{month:6,number:4,type:["kasu"]},{month:7,number:1,type:["tane","inoshikacho"]},{month:7,number:2,type:["tan"]},{month:7,number:3,type:["kasu"]},{month:7,number:4,type:["kasu"]},{month:8,number:1,type:["hikari"]},{month:8,number:2,type:["tane"]},{month:8,number:3,type:["kasu"]},{month:8,number:4,type:["kasu"]},{month:9,number:1,type:["tane"]},{month:9,number:2,type:["tan","aotan"]},{month:9,number:3,type:["kasu"]},{month:9,number:4,type:["kasu"]},{month:10,number:1,type:["tane","inoshikacho"]},{month:10,number:2,type:["tan","aotan"]},{month:10,number:3,type:["kasu"]},{month:10,number:4,type:["kasu"]},{month:11,number:1,type:["hikari","ame"]},{month:11,number:2,type:["tane"]},{month:11,number:3,type:["tan"]},{month:11,number:4,type:["kasu"]},{month:12,number:1,type:["hikari"]},{month:12,number:2,type:["kasu"]},{month:12,number:3,type:["kasu"]},{month:12,number:4,type:["kasu"]}],C=function(){function e(t){var n=this;Object(p["a"])(this,e),this.handCards=[],this.tableCards=[],this.receive_addCards0=function(e){b(e,"add-cards-to-deck",0),m("draw-and-discard-expose",0)},this.receive_dealTable0=function(e){b(e,"draw-and-discard-expose",0),n.tableCards.push(e.card),n.protocol[0]===n.receive_dealTable0?m("draw-and-discard-expose",0):m("draw",0)},this.receive_dealOpponent=function(e){b(e,"draw",1)},this.receive_dealMe=function(e){b(e,"draw",0),n.handCards.push(e.card),n.protocol[0]===n.receive_dealMe?m("draw",0):m("pass",1)},this.receive_dealEndOpponent=function(e){b(e,"pass",0),t.endInitialization(n.handCards,n.tableCards)},this.receive_dealEndMe=function(e){b(e,"pass",1)},this.protocol=[this.receive_addCards0].concat(y(this.receive_dealTable0)).concat(y(this.receive_dealMe)).concat(this.receive_dealEndMe).concat(y(this.receive_dealOpponent)).concat(this.receive_dealEndOpponent),m("add-cards-to-deck",0,void 0,{cards:g})}return Object(f["a"])(e,[{key:"receive",value:function(e){this.protocol.shift()(e)}}]),e}(),_=function(){function e(t){var n=this;Object(p["a"])(this,e),this.handCards=[],this.tableCards=[],this.receive_addCards1=function(e){b(e,"add-cards-to-deck",0),console.assert(v(e.cards,g))},this.receive_dealTable1=function(e){b(e,"draw-and-discard-expose",0),n.tableCards.push(e.card)},this.receive_dealOpponent=function(e){b(e,"draw",0)},this.receive_dealMe=function(e){b(e,"draw",1),n.handCards.push(e.card),n.protocol[0]===n.receive_dealMe?m("draw",1):m("pass",0)},this.receive_dealEndOpponent=function(e){b(e,"pass",1),m("draw",1)},this.receive_dealEndMe=function(e){b(e,"pass",0),t.endInitialization(n.handCards,n.tableCards)},this.protocol=[this.receive_addCards1].concat(y(this.receive_dealTable1)).concat(y(this.receive_dealOpponent)).concat(this.receive_dealEndOpponent).concat(y(this.receive_dealMe)).concat(this.receive_dealEndMe)}return Object(f["a"])(e,[{key:"receive",value:function(e){this.protocol.shift()(e)}}]),e}(),k=(n("ac1f"),n("466d"),n("ade3")),O=function(){function e(t,n){var a=this;Object(p["a"])(this,e),Object(k["a"])(this,"oldPoint",void 0),Object(k["a"])(this,"selectedCard",void 0),Object(k["a"])(this,"turn",void 0),this.game=t,this.oldPoint=n,this.turn=t.playerTurn,this.receive_step1=function(e){var n=t.tableCandidates(e.card.month).length;switch(n){case 0:t.addTable(e.card);break;case 1:case 3:t.match(e.card,void 0,!0);break;case 2:console.assert(void 0!==e.gameInfo),t.match(e.card,e.gameInfo,!0);break;default:console.log("not implemented")}m("draw-and-discard-expose",a.turn)},this.receive_step2=function(e){a.selectedCard=e.card;var n=t.tableCandidates(e.card.month).length;2!==n&&m("pass",a.turn)},this.receive_step3=function(e){var n=t.tableCandidates(a.selectedCard.month).length;switch(n){case 0:t.addTable(a.selectedCard);break;case 1:case 3:t.match(a.selectedCard,void 0,!0);break;case 2:console.assert(void 0!==e.gameInfo),t.match(a.selectedCard,e.gameInfo,!0);break;default:console.log("not implemented")}m("pass",1-a.turn)},this.receive_step4=function(){t.endMyTurn()},this.protocol=[this.receive_step1,this.receive_step2,this.receive_step3,this.receive_step4]}return Object(f["a"])(e,[{key:"receive",value:function(e){this.protocol.shift()(e)}},{key:"selectHand",value:function(e){this.protocol[0]===this.receive_step1&&(this.selectedCard=e)}},{key:"selectTable",value:function(e){if(this.protocol[0]===this.receive_step1){var t,n=this.game.tableCandidates(this.selectedCard.month);if(0!==n.length&&this.selectedCard.month!==e.month)return;2===n.length&&(t=e),m("discard-expose",this.turn,t,{card:this.selectedCard})}else if(this.protocol[0]===this.receive_step3){if(this.selectedCard.month!==e.month)return;m("pass",this.turn,e)}}}]),e}(),w=function(){function e(t,n){var a=this;Object(p["a"])(this,e),Object(k["a"])(this,"oldPoint",void 0),Object(k["a"])(this,"drawCard",void 0),this.game=t,this.oldPoint=n,this.receive_step1=function(e){console.log("receive_step1:"+JSON.stringify(e)),b(e,"discard-expose",1-t.playerTurn);var n=t.tableCandidates(e.card.month).length;switch(n){case 0:t.addTable(e.card);break;case 1:case 3:t.match(e.card,void 0,!1);break;case 2:console.assert(void 0!==e.gameInfo),t.match(e.card,e.gameInfo,!1);break;default:console.log("not implemented")}},this.receive_step2=function(e){console.log("receive_step2:"+JSON.stringify(e)),b(e,"draw-and-discard-expose",1-t.playerTurn),a.drawCard=e.card},this.receive_step3=function(e){console.log("receive_step3:"+JSON.stringify(e)),b(e,"pass",1-t.playerTurn);var n=a.drawCard,s=t.tableCandidates(n.month).length;switch(s){case 0:t.addTable(n);break;case 1:case 3:t.match(n,void 0,!1);break;case 2:console.assert(void 0!==e.gameInfo),t.match(n,e.gameInfo,!1);break;default:console.log("not implemented")}},this.receive_step4=function(e){console.log("receive_step4:"+JSON.stringify(e)),b(e,"pass",t.playerTurn),t.endOpTurn()},this.protocol=[this.receive_step1,this.receive_step2,this.receive_step3,this.receive_step4]}return Object(f["a"])(e,[{key:"receive",value:function(e){this.protocol.shift()(e)}}]),e}(),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card",on:{click:function(t){return e.$emit("click")}}},[n("img",{staticClass:"img",style:{border:"1px solid "+e.borderColor},attrs:{src:"images/"+e.card.month+"-"+e.card.number+".png"}})])},T=[],j={name:"Card",props:{card:Object,borderColor:{type:String,default:"transparent"}}},x=j,S=(n("e602"),n("2877")),M=Object(S["a"])(x,P,T,!1,null,"7a86b727",null),J=M.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pointPile"},[n("div",{staticClass:"hikarifuda"},[n("span"),e._l(e.hikarifuda,(function(e){return n("card",{key:JSON.stringify(e),staticClass:"card",attrs:{card:e}})}))],2),n("div",{staticClass:"tane"},e._l(e.tane,(function(e){return n("card",{key:JSON.stringify(e),staticClass:"card",attrs:{card:e}})})),1),n("div",{staticClass:"tan"},e._l(e.tan,(function(e){return n("card",{key:JSON.stringify(e),staticClass:"card",attrs:{card:e}})})),1),n("div",{staticClass:"kasu"},e._l(e.kasu,(function(e){return n("card",{key:JSON.stringify(e),staticClass:"card",attrs:{card:e}})})),1)])},E=[],I=(n("caad"),n("2532"),{name:"PointPile",components:{Card:J},props:{cards:Array},computed:{hikarifuda:function(){return this.cards.filter((function(e){return e.type.includes("hikari")}))},tane:function(){return this.cards.filter((function(e){return e.type.includes("tane")}))},tan:function(){return this.cards.filter((function(e){return e.type.includes("tan")}))},kasu:function(){return this.cards.filter((function(e){return e.type.includes("kasu")}))}}}),$=I,H=(n("5caf"),Object(S["a"])($,N,E,!1,null,"3284c98b",null)),R=H.exports,z={name:"Game",components:{PointPile:R,Card:J},data:function(){return{handCards:[],tableCards:[],myPointPile:[],opPointPile:[],state:void 0,playerTurn:void 0}},computed:{opponentTurn:function(){return 1-this.playerTurn},selectedCard:function(){return this.state instanceof O?this.state.selectedCard:void 0},selectedMonth:function(){return this.selectedCard?this.selectedCard.month:void 0}},created:function(){u.on("s2c_game-start",this.gameStart),u.on("s2c_play_response",this.receiveResponse),u.on("s2c_play_broadcast",this.receiveBroadcast)},methods:{gameStart:function(e){this.playerTurn=e.turn,0===this.playerTurn?this.state=new C(this):this.state=new _(this)},addTable:function(e){this.tableCards.push(e)},endInitialization:function(e,t){this.handCards=e,this.tableCards=t,0===this.playerTurn?this.state=new O(this,0):this.state=new w(this,0)},endMyTurn:function(){this.state=new w(this,0)},endOpTurn:function(){this.state=new O(this,0)},selectHand:function(e){this.state instanceof O&&this.state.selectHand(this.handCards[e])},selectTable:function(e){this.state instanceof O&&this.state.selectTable(this.tableCards[e])},match:function(e,t,n){var a=this;switch(console.log(n),this.tableCandidates(e.month).length){case 2:console.assert(e.month===t.month),n?(this.myPointPile.push(e,t),this.handCards=this.handCards.filter((function(t){return!v(t,e)}))):this.opPointPile.push(e,t),this.tableCards=this.tableCards.filter((function(e){return!v(e,t)}));break;case 1:case 3:this.tableCards.filter((function(t){return t.month===e.month})).forEach((function(e){return n?a.myPointPile.push(e):a.opPointPile.push(e)})),n?(this.myPointPile.push(e),this.handCards=this.handCards.filter((function(t){return!v(t,e)}))):this.opPointPile.push(e),this.tableCards=this.tableCards.filter((function(t){return t.month!==e.month}));break;default:console.assert(!1)}},tableCandidates:function(e){return this.tableCards.filter((function(t){return t.month===e}))},receiveResponse:function(e){this.state.receive(e)},receiveBroadcast:function(e){this.state.receive(e)}}},A=z,B=(n("c7ac"),Object(S["a"])(A,l,h,!1,null,"f83c9fe6",null)),G=B.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[e._l(e.messages,(function(t,a){return n("p",{key:a},[e._v(" "+e._s(t.from+"> "+t.message)+" ")])})),n("input",{directives:[{name:"model",rawName:"v-model",value:e.draft,expression:"draft"}],domProps:{value:e.draft},on:{input:function(t){t.target.composing||(e.draft=t.target.value)}}}),n("button",{attrs:{type:"button"},on:{click:function(t){return e.sendMessage()}}},[e._v("送信")])],2)},D=[],Y={name:"Chat",data:function(){return{messages:[{from:"Alice",message:"Hello"},{from:"Bob",message:"こんにちは"}],draft:"",enabled:!1}},created:function(){u.on("s2c_chat",this.receiveMessage)},methods:{sendMessage:function(){u.emit("c2s_chat",{message:this.draft}),this.messages.push({from:"You",message:this.draft}),this.draft=""},receiveMessage:function(e){console.log(this.messages),this.messages.push(e)}}},F=Y,K=(n("2655"),Object(S["a"])(F,q,D,!1,null,"440260de",null)),L=K.exports,Q={name:"Room",components:{Game:G,Chat:L},data:function(){return{socket:u}},created:function(){u.on("s2c_error",(function(e){alert(JSON.stringify(e))})),u.on("s2c_created-room",(function(e){alert(JSON.stringify(e))})),u.on("s2c_joined-room",(function(e){alert(JSON.stringify(e))})),u.on("s2c_game-start",(function(e){alert(JSON.stringify(e))})),u.emit("c2s_request-matching",{gameID:0,nickname:"anonymous"})}},U=Q,V=(n("3fac"),Object(S["a"])(U,i,o,!1,null,"5b66b71f",null)),W=V.exports,X={name:"App",components:{Room:W}},Z=X,ee=(n("034f"),Object(S["a"])(Z,s,r,!1,null,null,null)),te=ee.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(te)}}).$mount("#app")},"5caf":function(e,t,n){"use strict";var a=n("966c"),s=n.n(a);s.a},8322:function(e,t,n){},"85ec":function(e,t,n){},"966c":function(e,t,n){},c7ac:function(e,t,n){"use strict";var a=n("eadb"),s=n.n(a);s.a},e602:function(e,t,n){"use strict";var a=n("8322"),s=n.n(a);s.a},eadb:function(e,t,n){}});
//# sourceMappingURL=app.06ad3891.js.map